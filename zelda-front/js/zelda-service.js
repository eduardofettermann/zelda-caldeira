const linksSTR = `{
  "5f6ce9d805615a85623ec2d4": {
    "name": "The Legend of Zelda: Tri Force Heroes",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714565/5f6ce9d805615a85623ec2d4_augiyz.jpg"
  },
  "5f6ce9d805615a85623ec2b7": {
    "name": "The Legend of Zelda",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714562/5f6ce9d805615a85623ec2b7_phjdzu.png"
  },
  "5f6ce9d805615a85623ec2b8": {
    "name": "The Legend of Zelda: A Link to the Past",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714562/5f6ce9d805615a85623ec2b8_p0phib.png"
  },
  "5f6ce9d805615a85623ec2ba": {
    "name": "The Legend of Zelda: Ocarina of Time",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714562/5f6ce9d805615a85623ec2ba_mt1pwd.jpg"
  },
  "5f6ce9d805615a85623ec2b9": {
    "name": "The Legend of Zelda: Oracle of Ages",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714563/5f6ce9d805615a85623ec2b9_o2qsaj.png"
  },
  "5f6ce9d805615a85623ec2bb": {
    "name": "The Legend of Zelda: Link's Awakening DX",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714563/5f6ce9d805615a85623ec2bb_hxjgjq.png"
  },
  "5f6ce9d805615a85623ec2bc": {
    "name": "The Legend of Zelda: Majora's Mask",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714563/5f6ce9d805615a85623ec2bc_v4pcfc.jpg"
  },
  "5f6ce9d805615a85623ec2bd": {
    "name": "Zelda II: The Adventure of Link",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714563/5f6ce9d805615a85623ec2bd_ltbwgm.jpg"
  },
  "5f6ce9d805615a85623ec2bf": {
    "name": "The Legend of Zelda: The Wind Waker",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714562/5f6ce9d805615a85623ec2bf_yrzui0.png"
  },
  "5f6ce9d805615a85623ec2be": {
    "name": "The Legend of Zelda: Twilight Princess",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714562/5f6ce9d805615a85623ec2be_vorwqo.png"
  },
  "5f6ce9d805615a85623ec2c0": {
    "name": "The Legend of Zelda: Oracle of Seasons",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714563/5f6ce9d805615a85623ec2c0_ynntdd.jpg"
  },
  "5f6ce9d805615a85623ec2c5": {
    "name": "The Legend of Zelda: Spirit Tracks",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714564/5f6ce9d805615a85623ec2c5_pfjb2r.jpg"
  },
  "5f6ce9d805615a85623ec2ca": {
    "name": "BS The Legend of Zelda: Ancient Stone Tablets",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714564/5f6ce9d805615a85623ec2ca_iy0lwt.jpg"
  },
  "5f6ce9d805615a85623ec2cf": {
    "name": "Hyrule Warriors",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714564/5f6ce9d805615a85623ec2cf_uc3pe3.jpg"
  },
  "5f6ce9d805615a85623ec2c1": {
    "name": "The Legend of Zelda: Four Swords Adventures",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714563/5f6ce9d805615a85623ec2c1_zflhpa.png"
  },
  "5f6ce9d805615a85623ec2d4": {
    "name": "The Legend of Zelda: Tri Force Heroes",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714565/5f6ce9d805615a85623ec2d4_augiyz.jpg"
  },
  "5f6ce9d805615a85623ec2c9": {
    "name": "The Legend of Zelda: Breath of the Wild",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714564/5f6ce9d805615a85623ec2c9_eiuobf.png"
  },
  "5f6ce9d805615a85623ec2ce": {
    "name": "The Legend of Zelda: Tri Force Heroes",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714564/5f6ce9d805615a85623ec2ce_eiuobf.png"
  },
  "5f6ce9d805615a85623ec2d3": {
    "name": "Zelda: The Wand of Gamelon",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714564/5f6ce9d805615a85623ec2d3_jsihdt.png"
  },
  "5f6ce9d805615a85623ec2c4": {
    "name": "The Legend of Zelda: Four Swords",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714564/5f6ce9d805615a85623ec2c4_mhyyvk.jpg"
  },
  "5f6ce9d805615a85623ec2c6": {
    "name": "The Legend of Zelda: The Minish Cap",
    "link": "https://res.cloudinary.com/dvdz0oxvr/image/upload/v1701714564/5f6ce9d805615a85623ec2c6_ghu8em.jpg"
  }
}`;
const linksJSON = JSON.parse(linksSTR);

const searchBtn = document.querySelector("#search-btn");
const divJogos = document.querySelector(".jogos");
var linhas = divJogos.querySelectorAll(".lista-jogos");
var todosJogos;
var linhaAtual = 0;
const jogosPorLinha = window.innerWidth > 1250 ? 5 : 4;

buscaTodosJogos();

async function buscaTodosJogos() {
  try {
    const url = "http://localhost:8080/zeldacaldeira/jogos";

    const response = await fetch(url);

    if (!response.ok) {
      throw new Error(`Erro na chamada da API: ${response.statusText}`);
    }

    const dados = await response.json();
    todosJogos = await dados.data;
    console.log(todosJogos);
    for (var i = 0; i < todosJogos.length; i++) {
      if (todosJogos[i].id != "5f6ce9d805615a85623ec2ce") {
        criaJogoHTML(todosJogos[i]);
      }
    }
    hover();
  } catch (error) {
    console.error("Erro ao chamar a API:", error);
  }
}

function criaJogoHTML(jogo) {
  if (linhas[linhaAtual].querySelectorAll(".jogo").length >= jogosPorLinha) {
    var ul = document.createElement("ul");
    ul.className = "lista-jogos";
    divJogos.appendChild(ul);
    linhas = divJogos.querySelectorAll(".lista-jogos");
    linhaAtual++;
  }
  // Crie um elemento li com a classe "jogo"
  var novoJogo = document.createElement("li");
  novoJogo.className = "jogo";

  // Crie um elemento "a" com o atributo href definido no link do jogo
  var linkJogo = document.createElement("a");

  // Crie um elemento div com a classe "jogo-cover"
  var divCover = document.createElement("div");
  divCover.className = "jogo-cover";
  var url = linksJSON[jogo.id].link;
  divCover.style.background = "url(" + url + ") center/cover";

  // Crie um elemento img com o atributo src definido na imagem do jogo
  var imgCover = document.createElement("img");
  imgCover.src = "../assets/addCover.png";
  imgCover.className = "hidden";

  // Crie um elemento p com o id "nome-jogo" e o texto do nome do jogo
  var nomeJogo = document.createElement("p");
  nomeJogo.textContent = jogo.name;
  nomeJogo.className = "hidden";

  // Adicione a imagem e o nome do jogo à div "jogo-cover"
  divCover.appendChild(imgCover);
  divCover.appendChild(nomeJogo);

  // Adicione a div "jogo-cover" ao link do jogo
  linkJogo.appendChild(divCover);

  // Adicione o link do jogo ao elemento li
  novoJogo.appendChild(linkJogo);

  // Adicione o novo jogo à div
  linhas[linhaAtual].appendChild(novoJogo);
}

function hover() {
  document.querySelectorAll(".jogo").forEach(function (jogo) {
    jogo.addEventListener("mouseover", function () {
      jogo.querySelector("img").classList.remove("hidden");
      jogo.querySelector("p").classList.remove("hidden");
    });

    jogo.addEventListener("mouseout", function () {
      jogo.querySelector("img").classList.add("hidden");
      jogo.querySelector("p").classList.add("hidden");
    });
  });
}
